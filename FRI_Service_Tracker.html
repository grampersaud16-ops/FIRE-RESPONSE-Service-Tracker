<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>NYC Service Call Tracker</title>
<style>
  body { font-family: Arial, sans-serif; margin: 20px; }
  h2 { text-align: center; }
  .borough-container { display: flex; justify-content: space-between; flex-wrap: wrap; }
  .borough { width: 23%; border: 1px solid #ccc; border-radius: 8px; padding: 10px; margin-bottom: 20px; }
  .borough h3 { text-align: center; }
  .job-card { background: #eee; border-radius: 5px; padding: 8px; margin-bottom: 10px; }
  .job-status { font-weight: bold; color: white; padding: 2px 6px; border-radius: 4px; }
  .status-open { background-color: red; }
  .status-completed { background-color: green; }
  .status-pending { background-color: orange; }
  .status-to-return { background-color: purple; }
  .job-card textarea { width: 100%; margin-top: 5px; resize: vertical; }
  .job-card input[type=text] { width: 100%; margin-bottom: 5px; }
  .job-card select { width: 100%; margin-bottom: 5px; }
  .add-job-form { margin-bottom: 10px; }
  button { width: 100%; padding: 5px; margin-top: 5px; }
</style>
</head>
<body>

<h2>NYC Service Call Tracker</h2>
<div class="borough-container">
  <div class="borough" id="Queens"><h3>Queens</h3></div>
  <div class="borough" id="Brooklyn"><h3>Brooklyn</h3></div>
  <div class="borough" id="Manhattan"><h3>Manhattan</h3></div>
  <div class="borough" id="Bronx"><h3>Bronx</h3></div>
</div>

<script>
let jobs = JSON.parse(localStorage.getItem('nycJobs')) || { Queens: [], Brooklyn: [], Manhattan: [], Bronx: [] };

// Function to save jobs to localStorage
function saveJobs() {
  localStorage.setItem('nycJobs', JSON.stringify(jobs));
}

// Function to create the "Add Job" form for each borough
function createAddJobForm(boroughDiv, boroughName) {
  const form = document.createElement('div');
  form.className = 'add-job-form';
  form.innerHTML = `
    <input type="text" placeholder="Job site" class="job-site">
    <input type="text" placeholder="Trouble/issues" class="job-trouble">
    <select class="job-status">
      <option value="open">Open</option>
      <option value="completed">Completed</option>
      <option value="pending">Pending</option>
      <option value="to-return">To Return</option>
    </select>
    <textarea placeholder="Notes/outcomes" class="job-notes"></textarea>
    <button>Add Job</button>
  `;
  boroughDiv.appendChild(form);

  const addButton = form.querySelector('button');
  addButton.addEventListener('click', () => {
    const site = form.querySelector('.job-site').value.trim();
    const trouble = form.querySelector('.job-trouble').value.trim();
    const status = form.querySelector('.job-status').value;
    const notes = form.querySelector('.job-notes').value.trim();

    if (!site || !trouble) return alert("Please enter job site and trouble/issues");

    const job = { site, trouble, status, notes };
    jobs[boroughName].push(job);
    saveJobs();
    renderJob(boroughDiv, job, boroughName);
    form.querySelector('.job-site').value = '';
    form.querySelector('.job-trouble').value = '';
    form.querySelector('.job-notes').value = '';
  });
}

// Function to render a job card
function renderJob(boroughDiv, job, boroughName) {
  const card = document.createElement('div');
  card.className = 'job-card';
  card.innerHTML = `
    <input type="text" value="${job.site}" class="job-site-edit">
    <input type="text" value="${job.trouble}" class="job-trouble-edit">
    <select class="job-status-edit">
      <option value="open" ${job.status==='open'?'selected':''}>Open</option>
      <option value="completed" ${job.status==='completed'?'selected':''}>Completed</option>
      <option value="pending" ${job.status==='pending'?'selected':''}>Pending</option>
      <option value="to-return" ${job.status==='to-return'?'selected':''}>To Return</option>
    </select>
    <div class="job-status ${'status-'+job.status}">${job.status.toUpperCase()}</div>
    <textarea class="job-notes-edit">${job.notes}</textarea>
  `;
  boroughDiv.appendChild(card);

  const siteInput = card.querySelector('.job-site-edit');
  const troubleInput = card.querySelector('.job-trouble-edit');
  const statusSelect = card.querySelector('.job-status-edit');
  const notesInput = card.querySelector('.job-notes-edit');
  const statusDiv = card.querySelector('.job-status');

  // Update localStorage when any field changes
  siteInput.addEventListener('input', () => { job.site = siteInput.value; saveJobs(); });
  troubleInput.addEventListener('input', () => { job.trouble = troubleInput.value; saveJobs(); });
  statusSelect.addEventListener('change', () => {
    job.status = statusSelect.value;
    statusDiv.textContent = job.status.toUpperCase();
    statusDiv.className = 'job-status status-' + job.status;
    saveJobs();
  });
  notesInput.addEventListener('input', () => { job.notes = notesInput.value; saveJobs(); });
}

// Initialize tracker
['Queens','Brooklyn','Manhattan','Bronx'].forEach(boroughName => {
  const boroughDiv = document.getElementById(boroughName);
  createAddJobForm(boroughDiv, boroughName);
  jobs[boroughName].forEach(job => renderJob(boroughDiv, job, boroughName));
});
</script>
</body>
</html>
